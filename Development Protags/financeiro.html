<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">


    <!-- CSS -->
    <link rel="stylesheet" href="./css/template.css">
    <link rel="stylesheet" href="./css/financeiro.css">
    <link rel="icon" href="./images/favicon.ico">
    <title>Financeiro</title>
</head>

<body>

    <!-- MENU DE NAVEGAÇÃO -->


    <div class="header">
        <nav class="navbar navbar-expand-lg navbar-light bg-transparent">
            <a href="./inicio.html"><img src="./images/Protags.png" alt="logo" class="logopng"></img></a>
            <button class="navbar-toggler me-2 transparent" type="button" data-toggle="collapse"
                data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 ms-4 pt-3">
                    <li class="nav-item">
                        <a class="nav-link active text-white ps-0" aria-current="page" href="./inicio.html">
                            <p class="texto pt-5">Inicio</p>
                        </a>
                    </li>

                    <div class="dropdown pt-5">
                        <button class="btn btn-secondary dropdown-toggle ps-0" type="button" id="dropdownMenuButton"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Contas
                        </button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="./apagar.html">A Pagar</a>
                            <a class="dropdown-item" href="./areceber.html">A Receber</a>
                        </div>
                    </div>


                    <div class="dropdown pt-5">
                        <button class="btn btn-secondary dropdown-toggle ps-0" type="button" id="dropdownMenuButton"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Pagamentos
                        </button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="./arealizar.html">A Realizar</a>
                            <a class="dropdown-item" href="./realizados.html">Realizados</a>
                        </div>
                    </div>
                    <li class="nav-item">
                        <a class="nav-link active text-white ps-0" href="./financeiro.html">
                            <p class="texto pt-5">Financeiro</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active text-white ps-0" href="./configurações.html">
                            <p class="texto pt-5">Configurações</p>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="dropdown pt-5">
                <button class="btn btn-secondary dropdown-toggle ps-0 pt-0 pb-0 text-center" type="button"
                    id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Usuário
                </button>
                <div class="dropdown-menu logout" aria-labelledby="dropdownMenuButton" id="dropMenuBtn">
                    <a class="dropdown-item" href="./perfil.html" id="">Perfil</a>
                    <a onclick="logout()" class="dropdown-item" href="" id="logout">Sair</a>
                </div>

            </div>
    </div>
    </nav>


    <!-- O QUE PRECISA SER DESENVOLVIDO -->

    <!--GRAFICO TIAGO-->

    <h1 class="text-center pt-4">Movimentações Financeiras</h1>
    <div class="container-fluid mt-5 col-sm-9 ps-5 pe-5 pt-5 pb-5" id="containerMovimentacoes">
        <div class="row">
            <div class="col">
                <div class="containerEntradaSaida">
                    <div class="entradaBox">
                        <h2> Entradas </h2>
                        <p class="box_green" id="entrada"> R$ 479,00 </p>
                        <h2> A receber </h2>
                        <p class="box_green" id="aReceber"> R$ 570,00 </p>
                    </div>
                    <div class="saidaBox">
                        <h3> Saidas </h3>
                        <p class="box_red" id="saida"> R$ 750,00 </p>
                        <h3> A pagar</h3>
                        <p class="box_red" id="aPagar"> R$ 980,00 </p>
                    </div>
                </div>

                <div class="informativos">
                    <h4> Informativo 1 </h4>
                    <p class="period_info_1" id="period_info_1"> Periodo: 04/04/2023 até 14/04/2023 </p>
                    <p class="result_info_1" id="resultInfo1"> Despesas maiores que receitas</p>
                </div>
                <div class="informativos">
                    <h4> Informativo 2 </h4>
                    <p class="period_info_2" id="period_info_2"> Periodo: 04/04/2023 até 14/04/2023 </p>
                    <p class="result_info_2" id="resultInfo2"> Saldo disponivel: (-) R$ 270,10 </p>
                </div>

            </div>
            <div class="col" id="graficoContainer">
                <div class="Movimentações_Recentes">Movimentações Recentes</div>
                <div class="pesquisaGrafico">
                    <div class="tituloPesquisaGrafico">
                        <h5>Inicio</h5>
                        <h5>Fim</h5>
                        <h5></h5>
                    </div>
                    <div class="boxPesquisaGrafico">
                        <p class="box_empty"> <input type="date" name="dataInicio" id="dataInicio"> </p>
                        <p class="box_empty"> <input type="date" name="dataFim" id="dataFim"> </p>
                        <p class="box_red_full"> <input type="button" value=" Filtrar " onclick="Filtrar()"
                                id="Filtrar"></p>
                    </div>
                </div>
                <div class="resultFiltro" id="resultFiltro">Movimentação entre 05/05/2023 a 14/05/2023</div>
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <script src="./js/apagar.js"></script>
                    <div class="chart-container3" style="position: relative; height: 65%; width: 100%;">
                        <canvas id="myChart3"></canvas>
                    </div>
                        <script>
                            localStorage.setItem('valorEntrada', [1050 , 553])
                            const dataBar = localStorage.getItem('valorEntrada')

                            const contasaPagar2 = JSON.parse(localStorage.getItem('contasaPagar'));
                                // Cria um array para armazenar os valores convertidos
                            const valores2 = [];
                                // Itera sobre cada objeto dentro do array contasaPagar
                            //for (const conta of contasaPagar) {
                                // Recupera o valor do objeto e remove o símbolo "R$" e quaisquer caracteres não numéricos
                            //const valorNumerico2 = parseFloat(contasaPagar2.valor.replace(/[^0-9.,]+/g, "").replace(",", "."));

                                // Adiciona o valor convertido ao array de valores
                            //valores2.push(valorNumerico2);
                            //}
                                // Calcula a soma dos valores usando reduce()
                            //const total2 = valores2.reduce((acc, curr) => acc + curr, 0);

                            const ctx3 = document.getElementById('myChart3');
                            new Chart(ctx3, {
                                type: 'bar',
                                data: data = {
                                    labels: [
                                        'Despesas',
                                        'Receitas'
                                    ],
                                    datasets: [{
                                        label: 'Movimentações financeiras',
                                        data: dataBar.split(','),
                                        backgroundColor: [
                                            'rgb(255, 99, 132)',
                                            'rgb(75, 192, 192)'
                                        ],
                                        hoverOffset: 4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false
                                }
                            });
                        </script>
                </div>
            </div>
        </div>
    </div>




    <!--GRAFICOS LUCAS-->

    <!-- PAI DO CONTAINER -->
    <h1 class="text-center pt-5">Dashboard geral</h1>

    <div class="container pt-5 col-sm-10" id="paiDoGrafico">

        <!--DIV DO GRÁFICO-->
        <div class="row" id="grafico">
            <div class="col-lg-6 col-md-12 mb-4">

                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <div class="chart-container" style="position: relative; height: 400px; width: 100%;">
                    <canvas id="myChart"></canvas>
                </div>
                <script>
                    const ctx = document.getElementById('myChart');
                    new Chart(ctx, {
                        type: 'doughnut',
                        data: data = {
                            labels: [
                                'Receitas Fixas',
                                'Receitas Variáveis',
                                'Despesas Fixas',
                                'Despesas Variáveis'
                            ],
                            datasets: [{
                                label: 'Dashboard Financeiro',
                                data: [300, 50, 100, 150],
                                backgroundColor: [
                                    'rgb(255, 99, 132)',
                                    'rgb(54, 162, 235)',
                                    'rgb(255, 205, 86)',
                                    'rgb(75, 192, 192)'
                                ],
                                hoverOffset: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                </script>
            </div>
            <!-- -->
            <div class="col-lg-6 col-md-12 mb-4">
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <div class="chart-container" style="position: relative; height: 400px; width: 100%;">
                    <canvas id="myChart2"></canvas>
                </div>
                <script>

                    const contasaPagar = JSON.parse(localStorage.getItem('contasaPagar'));

                    // Cria um array para armazenar os valores convertidos
                    const valores = [];

                    // Itera sobre cada objeto dentro do array contasaPagar
                    for (const conta of contasaPagar) {
                        // Recupera o valor do objeto e remove o símbolo "R$" e quaisquer caracteres não numéricos
                        const valorNumerico = parseFloat(conta.valor.replace(/[^0-9.,]+/g, "").replace(",", "."));

                        // Adiciona o valor convertido ao array de valores
                        valores.push(valorNumerico);
                    }

                    // Calcula a soma dos valores usando reduce()
                    const total = valores.reduce((acc, curr) => acc + curr, 0);

                    const ctx2 = document.getElementById('myChart2');
                    new Chart(ctx2, {
                        type: 'bar',
                        data: data = {
                            labels: [
                                'Despesas',
                                'Receitas'
                            ],
                            datasets: [{
                                label: 'Movimentações financeiras',
                                data: [total],
                                backgroundColor: [
                                    'rgb(255, 99, 132)',
                                    'rgb(75, 192, 192)'
                                ],
                                hoverOffset: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                </script>
            </div>
        </div>
    </div>






    <!-- RODAPÉ DA PÁGINA -->

    <footer class="bg-light text-center text-lg-start">
        <div class="text-center p-3" id="footer">
            © 2023
            <a class="text-light" href="./index.html">Protags</a>
        </div>
    </footer>



    <!--Script Financeiro-->
    <script src="./js/financeiro.js"></script>

    <!--Script Bootstrap-->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
</body>

</html>